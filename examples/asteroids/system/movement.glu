let { negate } = import! std.num
let { pi } = import! std.float

let { AddComponent, Position, Motion, Rotation, Direction, ? } = import! component

let update r : { input: Input, pos : Position, rot: Rotation } -> { pos : Position, rot : Rotation } =
    let { input, pos, rot } = r

    let rot_diff =
        match input.direction with
        | Left -> -0.1
        | Right -> 0.1
        | None -> 0.0

    { pos = pos + { x = 1., y = 0. }, rot = rot + rot_diff }

update
